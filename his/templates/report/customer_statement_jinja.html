<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title> {{ frappe.db.get_value("Customer", filters['party'][0],
                "customer_name") }}</title>
    <!-- <link rel="stylesheet" href="style.css" /> -->
  </head>
  <style>
    @media screen {
     .print-format-gutter {
         background-color: #d1d8dd;
         padding: 30px 0px;
    }
     .print-format {
         background-color: white;
         box-shadow: 0px 0px 9px rgba(0,0,0,0.5);
         max-width: 8.3in;
         min-height: 11.69in;
         padding: 0.25in;
         margin: auto;
    }
     .print-format.landscape {
         max-width: 11.69in;
         padding: 0.2in;
    }
     .page-break {
         padding: 30px 0px;
         border-bottom: 1px dashed #888;
    }
     .page-break:first-child {
         padding-top: 0px;
    }
     .page-break:last-child {
         border-bottom: 0px;
    }
    /* mozilla hack for images in table */
     body:last-child .print-format td img {
         width: 100% !important;
    }
     @media(max-width: 767px) {
         .print-format {
             padding: 0.2in;
        }
    }
}
 @media print {
     .print-format p {
         margin-left: 1px;
         margin-right: 1px;
    }
}
 .disabled-check {
     color: #eee;
}
 .data-field {
     margin-top: 5px;
     margin-bottom: 5px;
}
 .data-field .value {
     word-wrap: break-word;
}
 .important .value {
     font-size: 120%;
     font-weight: bold;
}
 .important label {
     line-height: 1.8;
     margin: 0px;
}
 .table {
     margin: 20px 0px;
}
 .square-image {
     width: 100%;
     height: 0;
     padding: 50% 0;
     background-size: contain;
    /*background-size: cover;
    */
     background-repeat: no-repeat !important;
     background-position: center center;
     border-radius: 4px;
}
 .print-item-image {
     object-fit: contain;
}
 .pdf-variables, .pdf-variable, .visible-pdf {
     display: none !important;
}
 .print-format {
     font-size: 9pt;
     font-family: "Helvetica Neue", Helvetica, Arial, "Open Sans", sans-serif;
     -webkit-print-color-adjust:exact;
}
 .print-format table {
     font-size: 9pt;
     font-family: "Helvetica Neue", Helvetica, Arial, "Open Sans", sans-serif;
     -webkit-print-color-adjust:exact;
}
 .page-break {
     page-break-after: always;
}
 .print-heading {
     border-bottom: 1px solid #aaa;
     margin-bottom: 10px;
}
 .print-heading h2 {
     margin: 0px;
}
 .print-heading h4 {
     margin-top: 5px;
}
 table.no-border, table.no-border td {
     border: 0px;
}
 .print-format label {
    /* wkhtmltopdf breaks label into multiple lines when it is inline-block */
     display: block;
}
 .print-format img {
     max-width: 100%;
}
 .print-format table td > .primary:first-child {
     font-weight: bold;
}
 .print-format td, .print-format th {
     vertical-align: top !important;
     padding: 6px !important;
}
 .print-format p {
     margin: 3px 0px 3px;
}
 table td div {
    /* needed to avoid partial cutting of text between page break in wkhtmltopdf */
     page-break-inside: avoid !important;
}
/* hack for webkit specific browser */
 @media (-webkit-min-device-pixel-ratio:0) {
     thead, tfoot {
         display: table-header-group;
    }
}
 [document-status] {
     margin-bottom: 5mm;
}
 .signature-img {
     background: #fff;
     border-radius: 3px;
     margin-top: 5px;
     max-height: 150px;
}
 .print-preview [data-fieldtype="Table"] {
     overflow: auto;
}
 .print-heading {
     text-align: right;
     text-transform: uppercase;
     color: #666;
     padding-bottom: 20px;
     margin-bottom: 20px;
     border-bottom: 1px solid #d1d8dd;
}
 .print-heading h2 {
     font-size: 24px;
}
 .print-format th {
     background-color: #eee !important;
     border-bottom: 0px !important;
}
/* modern format: for-test */

/* ------------------------------------new----------------- */


.section_1 {
  max-width: 1110px;
  margin: 0 auto;
}
.section_1 img{
  width: 752px !important;
}
.date {
  display: flex; 
  justify-content: end;
  margin-right: 20px;
}
.heading h2 {
  display: flex;
  justify-content: center;
  align-items: center;
}
.divided_two {
  /* display: grid;
    grid-template-columns: repeat(2,1fr); */
  display: flex;
  gap: 20px;
  width: 100%;
  /* justify-content: space-between; */
  /* margin-left: 300px; */
}
.sec_1 {
  /* margin-left: 40px; */
}
.table {
  margin: 20px 0px;
}
table,
th,
td {
  border: 1px solid gray;
  border-collapse: collapse;
  padding: 4px;
}

.sec_2 {
  margin-left: 30px;
}
.sec_1 td {
  width: 250px;
  height: 30px;
}

.sec_2 td {
  display: flex;
  flex-direction: row;
  width: 340px;
  height: 30px;
}

/* ...................  table three */
.right_side {
  display: flex;
  /* justify-content: center;
margin-left: 370px; */
  margin-top: 20px;
}
.right_side th {
  width: 110px;
}
.right_side td {
  height: 30px;
  width: 110px;
}

/* .......................... table four........... */
.table_four {
  /* margin-left: 275px; */
  margin-top: 10px;
}
.table_four th {
  width: 130px;
  height: 10px;
  font-weight: bold;
}

.tr_td_wid td {
  height: 20px;
}

/* ............................... responsitive mobile  */
</style>
  <body>
    <section class="print-format-gutter">
      <div class="print-format" class="hidden-pdf">
        <div style="display: flex; justify-content: space-between; align-items: center;">

          <div class="date">
            <h3>Printed Date: {{ _("{0}").format(date_time) }}</h3>
          </div>
          <div class="user">
            <h3>Printed By: {{ frappe.db.get_value ("User" ,frappe.session.user, "full_name") }}</h3>
          </div>
        </div>
      <div id="header-html">
        {% if letter_head %}
        <div class="letter-head">
          {{ letter_head }}
        </div>
        {% endif %}
      </div>

      <div class="heading">
        <h2>CUSTOMER STATEMENT</h2>
      </div>
      <!-- ................ table one containin two table  -->
      <div class="divided_two">
        <!-- ........one  -->
        <div style="width: 100%;">
          <table style="width: 100%;" class="table table-bordered">
            <tr>
              <th style="text-align: left;">ID</th>
              <td>{{ filters['party'][0] }}</td>
            </tr>

            <tr>
              <th style="text-align: left;">Name</th>
              <td>
                {{ frappe.db.get_value("Customer", filters['party'][0],
                "customer_name") }}
              </td>
            </tr>
          </table>
        </div>
        <!-- ......... two -->
        <div style="width: 100%;">
          <table style="width: 100%;" class="table table-bordered">
            <tr>
              <th style="text-align: left;" >Date From</th>
              <td>
                {{ frappe.format(filters['from_date'] , {'fieldtype': 'Date'})}}
              </td>
            </tr>

            <tr>
              <th style="text-align: left;">Date To</th>
              <td>
                {{ frappe.format(filters['to_date'] , {'fieldtype': 'Date'})}}
              </td>
            </tr>
          </table>
        </div>
      </div>
      <!-- .................... table three  -->
      <div style="width: 100%; margin-top: -2%;">
        <table style="width: 100%;" class="table table-bordered">
          <tr>
            <th style="text-align: left;">Begining</th>
            <th style="text-align: left;">Total Debit</th>
            <th style="text-align: left;">Total Credit</th>
            <th style="text-align: left;">Total Balance</th>
          </tr>
          <tr>
            <td>{{data[0].balance }}</td>
            <td>{{data[-1].debit }}</td>
            <td>{{data[-1].credit }}</td>
            <td>{{data[-1].balance }}</td>
          </tr>
        </table>
      </div>
      <div  class="" style="width: 100%;">
        <table style="width: 100%;" class="table table-bordered">
          <tr>
            <th style="text-align: left;">Date</th>
            <!-- <th style="text-align: left;">Time</th> -->
            <th style="text-align: left;">User</th>

            {% if frappe.db.get_value("Customer", filters['party'][0],"customer_group")!= "Insurance" %}
            <th style="text-align: left;">Type</th>
            {% endif %}
            
            <th style="text-align: left;">Description</th>
            <th style="text-align: left;">Refrence</th>
            <th style="text-align: left;">Debit</th>
            <th style="text-align: left;">Credit</th>
            <th style="text-align: left;">Balance</th>
          </tr>
          {% for row in data %} {% if(row.posting_date) %}
          <!-- <td> {{frappe.db.get_value(row.voucher_type, row.voucher_no, "posting_time") }}</td>
            <td> {{ frappe.db.get_value("User",frappe.db.get_value(row.voucher_type, row.voucher_no, "owner"),"full_name") }}</td> -->
            
          <tr>
            <td style="width: 18%;"> {{row.posting_date }}</td>
              <!-- <td>     {{ frappe.utils.format_time(frappe.db.get_value(row.voucher_type, row.voucher_no, "posting_time")) if frappe.db.get_value(row.voucher_type, row.voucher_no, "posting_time") else "" }} -->
              </td>
            <td> {{ frappe.db.get_value("User",frappe.db.get_value(row.voucher_type, row.voucher_no, "owner"),"full_name") }}</td> 
            
            {% if frappe.db.get_value("Customer", filters['party'][0],"customer_group")!= "Insurance" %}
            <td>
              {% if row.voucher_type == "Sales Invoice" %}
              <span style="font-size: 14px">Sales</span>

              {% endif %} 
              {% if row.voucher_type == "Payment Entry" %}
              <span style="font-size: 14px">Reciept</span>

              {% endif %}
              {% if row.voucher_type == "Journal Entry" %}
              
              <span style="font-size: 14px">Transfered</span>

              {% endif %}
            </td>
            {% endif %}
            
            
            <td style="width: 25%;">
              {% if row.voucher_type == "Sales Invoice" %} {% set sales_doc =
                frappe.get_doc("Sales Invoice" , row.voucher_no) %}<br />
                {% set item_group = [] %} 
                {% for item in sales_doc.items %} 
                {% if item.item_group %} 
                {% if item.item_group not in item_group %} {%
                set item_group = item_group.append(item.item_group) %}
  
                <span 
                style="font-size: 14px">{{item.item_group }} <br>
                
                {% endif %} {% endif %} {% endfor %}
                <span style="font-size: 12px ; font-style: italic;">  Total :</span> {{ frappe.utils.fmt_money(frappe.db.get_value(row.voucher_type, row.voucher_no, "total")  ,currency=currency)}} <br>
                <span style="font-size: 12px ; font-style: italic;">  Discount : </span>{{ frappe.utils.fmt_money(frappe.db.get_value(row.voucher_type, row.voucher_no, "discount_amount") ,currency=currency) }}
                </span>
  
                {% endif %} 
                
              {% if row.voucher_type == "Payment Entry" %}
              {% set p_d = frappe.get_doc("Payment Entry" , row.voucher_no) %}
              <span style="font-size: 14px">  
                
                <span style="font-size: 14px">{{ frappe.db.get_value("Payment Entry", row.voucher_no, "remarks") or ""}} <br>
                  <span style="font-size: 12px ; font-style: italic;">  Paid Amount :</span> {{ frappe.utils.fmt_money(p_d.paid_amount  ,currency=currency)}} <br>
                  <span style="font-size: 12px ; font-style: italic;">  Discount : </span>{{ frappe.utils.fmt_money(row.credit - p_d.paid_amount ,currency=currency) }}
    
                </span>
              </span>
              
              {% endif %}
              {% if row.voucher_type == "Journal Entry" %}
              {% if frappe.db.get_value("Customer", filters['party'][0],"customer_group")== "Insurance" %}
              <span style="line-break: anywhere;">  <p>{{ frappe.db.get_value("Journal Entry", row.voucher_no, "patient") or ""}} </p>{{ frappe.db.get_value("Journal Entry", row.voucher_no, "patient_name") or ""}}</span>
              {% else %}
              <span style="line-break: anywhere;">{{ frappe.db.get_value("Journal Entry", row.voucher_no, "remark") or ""}}</span>
              {% endif %}
             
              {% endif %}
            </td>
            <td>
              <a href='/app/{{row.voucher_type  | lower | replace(" ", "-") }}/{{row.voucher_no}}' target="_blank"> {{row.voucher_no.split("-")[3] }}</a>
            </td>

            <td style="width: 13%;">{{frappe.utils.fmt_money(row.debit, currency=currency)}}</td>
            <!-- {% if row.voucher_type == "Payment Entry" %}
            <td>{{frappe.utils.fmt_money(row.credit, currency=currency)}} <br>
              <span style="font-size: 14px">Paid:{{ frappe.db.get_value("Payment Entry", row.voucher_no, "paid_amount")}} <br>Disc: {{ frappe.db.get_value("Payment Entry Deduction", {"parent": row.voucher_no}, "amount") or 0}}</span>
            </td>
            {% endif %} -->
            <td style="width: 13%;">{{frappe.utils.fmt_money(row.credit, currency=currency)}}</td>
         

            
            <td style="width: 15%;">{{frappe.utils.fmt_money(row.balance, currency=currency)}}</td>
          </tr>
          {% endif %} {% endfor %}
        </table>
      </div>
      <!-- ..............table four ............ -->
    </div>
    </section>
  </body>
</html>
